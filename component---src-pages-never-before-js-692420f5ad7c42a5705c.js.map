{"version":3,"file":"component---src-pages-never-before-js-692420f5ad7c42a5705c.js","mappings":"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","sources":["webpack://endlesswips/./src/pages/never-before.js"],"sourcesContent":["import React from \"react\";\r\nimport Layout from \"../components/layout\";\r\nimport SEO from \"../components/seo\";\r\nimport Spinner from \"../components/spinner\";\r\nimport Utils from \"../helpers/utils\";\r\n\r\nimport sha256 from \"crypto-js/sha256\";\r\nimport Base64 from \"crypto-js/enc-base64\";\r\n\r\nimport KaleidoscopeColoring from \"../components/kaleidoscope-coloring\";\r\n\r\nclass NeverBefore extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      uniqueId: undefined,\r\n      variant: undefined,\r\n      quality: 4,\r\n      color: false,\r\n      page: 1,\r\n    };\r\n  }\r\n\r\n  getFieldUpdateFunction(fieldName) {\r\n    return function (e) {\r\n      let stateUpdate = {};\r\n      if (e.target.type === \"checkbox\") {\r\n        stateUpdate[fieldName] = e.target.checked;\r\n      } else {\r\n        stateUpdate[fieldName] = e.target.value;\r\n      }\r\n      this.setState(stateUpdate);\r\n    }.bind(this);\r\n  }\r\n\r\n  changePageNumber(delta) {\r\n    return function () {\r\n      if (this.state.page + delta >= 1 && this.state.page + delta <= 50)\r\n        this.setState({ page: this.state.page + delta });\r\n    }.bind(this);\r\n  }\r\n\r\n  // TODO: use ref!\r\n  downloadCanvas() {\r\n    console.log(\"Download\");\r\n    let link = document.createElement(\"a\");\r\n    link.download = `pattern.png`;\r\n    link.href = document.getElementById(\"canvas\").toDataURL();\r\n    link.click();\r\n  }\r\n\r\n  componentDidMount() {\r\n    let queryObject = Utils.getQueryObj();\r\n    if (queryObject.uniqueId !== undefined) {\r\n      this.setState({\r\n        uniqueId: Utils.invMakeBase64UrlSafe(queryObject.uniqueId),\r\n      });\r\n    } else if (queryObject.id !== undefined) {\r\n      this.setState({\r\n        uniqueId: Utils.invMakeBase64UrlSafe(queryObject.id),\r\n      });\r\n    } else {\r\n      this.setState({ uniqueId: null });\r\n    }\r\n    if (queryObject.variant !== undefined) {\r\n      this.setState({ variant: queryObject.variant });\r\n    } else {\r\n      this.setState({ variant: null });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    let inputHash = this.state.uniqueId;\r\n    for (let i = 1; i < this.state.page; i++) {\r\n      let lastChar = inputHash.slice(-1);\r\n      console.log(lastChar);\r\n      if (lastChar !== \"=\") {\r\n        inputHash = Utils.invMakeBase64UrlSafe(inputHash) + \"=\";\r\n      } else {\r\n        inputHash = Utils.invMakeBase64UrlSafe(inputHash);\r\n      }\r\n      console.log(\"HASH\", inputHash);\r\n      inputHash = Base64.stringify(sha256(inputHash));\r\n    }\r\n\r\n    let content = <Spinner></Spinner>;\r\n    if (this.state.uniqueId === null || this.state.variant === null) {\r\n      content = (\r\n        <div>\r\n          <p>\r\n            Please enter the <b>uniqueId</b> and <b>variant</b> of your coloring\r\n            book. These can be found of the back cover.\r\n          </p>\r\n          <div>\r\n            <label htmlFor=\"variant\">Variant</label>\r\n            <div>\r\n              <input\r\n                id=\"variant\"\r\n                name=\"variant\"\r\n                type=\"text\"\r\n                placeholder=\"\"\r\n                onChange={function (e) {\r\n                  this.setState({\r\n                    uniqueId: e.target.value,\r\n                  });\r\n                }.bind(this)}\r\n              ></input>\r\n            </div>\r\n            <label htmlFor=\"uniqueId\">UniqueId</label>\r\n            <div>\r\n              <input\r\n                id=\"uniqueId\"\r\n                name=\"uniqueId\"\r\n                type=\"text\"\r\n                placeholder=\"\"\r\n                onChange={function (e) {\r\n                  this.setState({\r\n                    variant: e.target.value,\r\n                  });\r\n                }.bind(this)}\r\n              ></input>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    } else if (\r\n      this.state.uniqueId !== null &&\r\n      this.state.uniqueId !== undefined &&\r\n      this.state.variant !== null &&\r\n      this.state.variant !== undefined\r\n    ) {\r\n      content = (\r\n        <div>\r\n          <div\r\n            style={{\r\n              display: \"flex\",\r\n              flexDirection: \"column\",\r\n              alignItems: \"center\",\r\n              marginBottom: \"4px\",\r\n            }}\r\n          >\r\n            <div\r\n              style={{\r\n                display: \"flex\",\r\n                flexDirection: \"column\",\r\n                alignItems: \"center\",\r\n              }}\r\n            >\r\n              <div>\r\n                UniqueId: <b>{Utils.makeBase64UrlSafe(this.state.uniqueId)}</b>\r\n              </div>\r\n              <div>\r\n                Variant: <b>{this.state.variant}</b>\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <button\r\n                class=\"button\"\r\n                onClick={this.changePageNumber(-1)}\r\n                style={{ marginRight: \"4px\" }}\r\n              >\r\n                {\"<\"}\r\n              </button>\r\n              Pattern{\" \"}\r\n              <input style={{ width: \"25px\" }} value={this.state.page}></input>{\" \"}\r\n              of 50\r\n              <button\r\n                class=\"button\"\r\n                onClick={this.changePageNumber(1)}\r\n                style={{ marginLeft: \"4px\" }}\r\n              >\r\n                {\">\"}\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <KaleidoscopeColoring\r\n            variant={null}\r\n            hash={inputHash}\r\n            quality={this.state.quality}\r\n            color={this.state.color}\r\n            key={sha256(this.state.quality)} // Re-make the canvas when the quality changes\r\n          ></KaleidoscopeColoring>\r\n\r\n          <div\r\n            style={{\r\n              display: \"flex\",\r\n              flexDirection: \"column\",\r\n              alignItems: \"center\",\r\n              marginBottom: \"4px\",\r\n            }}\r\n          >\r\n            <div>\r\n              <input\r\n                type=\"checkbox\"\r\n                id=\"color\"\r\n                name=\"color\"\r\n                onChange={this.getFieldUpdateFunction(\"color\")}\r\n                //checked={this.state.color}\r\n              ></input>\r\n              <label htmlFor=\"color\"> Color it for me</label>\r\n            </div>\r\n            <div style={{ display: \"flex\" }}>\r\n              <input\r\n                id=\"quality\"\r\n                type=\"range\"\r\n                min=\"1\"\r\n                max=\"10\"\r\n                onChange={this.getFieldUpdateFunction(\"quality\")}\r\n                value={this.state.quality}\r\n              ></input>\r\n              <label\r\n                for=\"quality\"\r\n                style={{\r\n                  padding: \"5px\",\r\n                }}\r\n              >\r\n                {\" \"}\r\n                Image Quality\r\n              </label>\r\n            </div>\r\n\r\n            <div>\r\n              <button class=\"button\" onClick={this.downloadCanvas}>\r\n                Download Pattern Image\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <Layout location={{ pathname: \"/never-before\" }}>\r\n        <SEO\r\n          title=\"NeverBefore Coloring\"\r\n          description=\"Coloring pages generated from user input text\"\r\n        />\r\n        <div\r\n          className=\"inner-home post-list-wrapper\"\r\n          style={{ justifyContent: \"center\" }}\r\n        >\r\n          {content}\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n}\r\n\r\nexport default NeverBefore;\r\n"],"names":["NeverBefore","props","state","uniqueId","undefined","variant","quality","color","page","getFieldUpdateFunction","fieldName","e","stateUpdate","target","type","checked","value","this","setState","bind","changePageNumber","delta","downloadCanvas","console","log","link","document","createElement","download","href","getElementById","toDataURL","click","componentDidMount","queryObject","Utils","id","render","inputHash","i","lastChar","slice","Base64","sha256","content","htmlFor","name","placeholder","onChange","style","display","flexDirection","alignItems","marginBottom","class","onClick","marginRight","width","marginLeft","hash","key","min","max","for","padding","location","pathname","title","description","className","justifyContent","React"],"sourceRoot":""}