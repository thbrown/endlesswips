{"version":3,"file":"component---src-pages-aoe-2-de-rating-charts-oauth-js-190df17c9f674e7fd0f1.js","mappings":"6+BAMA,IAAMA,EAAwB,CAAC,QAAS,OAAQ,SAE1CC,EAAAA,SAAAA,GACJ,WAAYC,GAAQ,IAAD,SACjB,cAAMA,IAAN,MACKC,MAAQ,CACXC,SAAU,QACVC,aAASC,GAJM,GADfL,EAAAA,EAAAA,GAAAA,EAAAA,GAOH,kBAoFA,OApFA,EAEDM,kBAAA,WAKE,IALmB,IAKnB,EALkB,OACZC,EAAcC,OAAOC,SAASC,OAC9BC,EAAY,IAAIC,gBAAgBL,GAGtC,IAAkBR,KAAlB,aAAyC,CAAC,IAAjCc,EAAgC,QAEvC,GADAC,QAAQC,IAAIF,EAAOF,EAAUK,IAAIH,IACJ,OAAzBF,EAAUK,IAAIH,GAKhB,YAJAI,KAAKC,SAAS,CACZf,SAAU,QACVC,QAAQ,2BAA4BS,EAA7B,MAObM,MAAM,gGAC4FR,EAAUK,IACxG,QAFC,UAGQL,EAAUK,IAAI,SAHtB,UAGwCL,EAAUK,IAAI,UAExDI,MAAK,SAAAC,GACJ,OAAuB,KAAnBA,EAASC,OACJC,QAAQC,UAERH,EAASI,UAGnBL,MAAK,SAAAM,GACAA,EACF,EAAKR,SAAS,CACZf,SAAU,QACVC,QAASsB,EAAKtB,UAGhB,EAAKc,SAAS,CACZf,SAAU,iBAInB,EAEDwB,OAAA,WACE,IAAIC,OAAUvB,EAgCd,MA/B4B,UAAxBY,KAAKf,MAAMC,SACbyB,EACE,2BACE,yDACA,uBACEC,MAAO,CACLC,WAAY,OACZC,OAAQ,OACRC,MAAO,SAGT,gBAAC,IAAD,QAI2B,UAAxBf,KAAKf,MAAMC,SACpByB,EACE,2BACE,8EACA,yBAAIX,KAAKf,MAAME,UAGc,aAAxBa,KAAKf,MAAMC,WACpByB,EACE,2BACE,sCACA,iFAMJ,gBAAC,IAAD,CAAQnB,SAAU,CAAEwB,SAAU,SAC5B,gBAAC,IAAD,CAAKC,MAAM,qBACX,uBAAKL,MAAO,CAAEM,UAAW,WAAaP,KAG3C,EA3FG5B,CAAcoC,EAAAA,WA8FpB","sources":["webpack://endlesswips/./src/pages/aoe2-de-rating-charts/oauth.js"],"sourcesContent":["import React from \"react\";\r\n\r\nimport Layout from \"../../components/layout\";\r\nimport SEO from \"../../components/seo\";\r\nimport Spinner from \"../../components/spinner\";\r\n\r\nconst REQUIRED_QUERY_PARAMS = [\"state\", \"code\", \"scope\"];\r\n\r\nclass OAuth extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      progress: \"start\",\r\n      message: undefined,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    const queryString = window.location.search;\r\n    const urlParams = new URLSearchParams(queryString);\r\n\r\n    // Verify required fields are present\r\n    for (let field of REQUIRED_QUERY_PARAMS) {\r\n      console.log(field, urlParams.get(field));\r\n      if (urlParams.get(field) === null) {\r\n        this.setState({\r\n          progress: \"error\",\r\n          message: `Missing required field '${field}'`,\r\n        });\r\n        return;\r\n      }\r\n    }\r\n\r\n    // Send the oAuth request\r\n    fetch(\r\n      `https://us-central1-age-of-empires-307521.cloudfunctions.net/twitch-rating-charts-oauth?code=${urlParams.get(\r\n        \"code\"\r\n      )}&state=${urlParams.get(\"state\")}&scope=${urlParams.get(\"scope\")}`\r\n    )\r\n      .then(response => {\r\n        if (response.status == 204) {\r\n          return Promise.resolve();\r\n        } else {\r\n          return response.json();\r\n        }\r\n      })\r\n      .then(data => {\r\n        if (data) {\r\n          this.setState({\r\n            progress: \"error\",\r\n            message: data.message,\r\n          });\r\n        } else {\r\n          this.setState({\r\n            progress: \"complete\",\r\n          });\r\n        }\r\n      });\r\n  }\r\n\r\n  render() {\r\n    let content = undefined;\r\n    if (this.state.progress === \"start\") {\r\n      content = (\r\n        <div>\r\n          <h1>Processing oAuth Request...</h1>\r\n          <div\r\n            style={{\r\n              paddingTop: \"25px\",\r\n              margin: \"auto\",\r\n              width: \"42px\",\r\n            }}\r\n          >\r\n            <Spinner></Spinner>\r\n          </div>\r\n        </div>\r\n      );\r\n    } else if (this.state.progress === \"error\") {\r\n      content = (\r\n        <div>\r\n          <h1>There was an error while processing your request</h1>\r\n          <p>{this.state.message}</p>\r\n        </div>\r\n      );\r\n    } else if (this.state.progress === \"complete\") {\r\n      content = (\r\n        <div>\r\n          <h1>Success!</h1>\r\n          <p>Processing complete, you may now close this window</p>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <Layout location={{ pathname: \"/404\" }}>\r\n        <SEO title=\"oAuth Processing\" />\r\n        <div style={{ textAlign: \"center\" }}>{content}</div>\r\n      </Layout>\r\n    );\r\n  }\r\n}\r\n\r\nexport default OAuth;\r\n"],"names":["REQUIRED_QUERY_PARAMS","OAuth","props","state","progress","message","undefined","componentDidMount","queryString","window","location","search","urlParams","URLSearchParams","field","console","log","get","this","setState","fetch","then","response","status","Promise","resolve","json","data","render","content","style","paddingTop","margin","width","pathname","title","textAlign","React"],"sourceRoot":""}