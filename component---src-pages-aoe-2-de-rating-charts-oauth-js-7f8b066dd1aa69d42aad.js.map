{"version":3,"sources":["webpack:///./src/components/spinner.js","webpack:///./src/pages/aoe2-de-rating-charts/oauth.js"],"names":["Spinner","render","id","style","this","props","className","React","Component","REQUIRED_QUERY_PARAMS","OAuth","state","progress","message","undefined","componentDidMount","queryString","window","location","search","urlParams","URLSearchParams","field","console","log","get","setState","fetch","then","response","status","Promise","resolve","json","data","content","paddingTop","margin","width","pathname","title","textAlign"],"mappings":"gIAIMA,G,4GACJC,OAAA,WACE,OACE,yBAAKC,GAAG,UAAUC,MAAOC,KAAKC,MAAMF,OAClC,yBAAKG,UAAU,mBACb,yBAAKA,UAAU,gBACf,yBAAKA,UAAU,gBACf,yBAAKA,UAAU,gBACf,yBAAKA,UAAU,gBACf,yBAAKA,UAAU,gBACf,yBAAKA,UAAU,mB,GAVHC,IAAMC,YAiBbR,O,o7BCff,IAAMS,EAAwB,CAAC,QAAS,OAAQ,SAE1CC,E,YACJ,WAAYL,GAAQ,IAAD,SACjB,cAAMA,IAAN,MACKM,MAAQ,CACXC,SAAU,QACVC,aAASC,GAJM,E,4CAQnBC,kBAAA,WAKE,IALmB,IAKnB,EALkB,OACZC,EAAcC,OAAOC,SAASC,OAC9BC,EAAY,IAAIC,gBAAgBL,GAGtC,IAAkBP,KAAlB,aAAyC,CAAC,IAAjCa,EAAgC,QAEvC,GADAC,QAAQC,IAAIF,EAAOF,EAAUK,IAAIH,IACJ,OAAzBF,EAAUK,IAAIH,GAKhB,YAJAlB,KAAKsB,SAAS,CACZd,SAAU,QACVC,QAAQ,2BAA4BS,EAA7B,MAObK,MAAM,gGAC4FP,EAAUK,IACxG,QAFC,UAGQL,EAAUK,IAAI,SAHtB,UAGwCL,EAAUK,IAAI,UAExDG,MAAK,SAAAC,GACJ,OAAuB,KAAnBA,EAASC,OACJC,QAAQC,UAERH,EAASI,UAGnBL,MAAK,SAAAM,GACAA,EACF,EAAKR,SAAS,CACZd,SAAU,QACVC,QAASqB,EAAKrB,UAGhB,EAAKa,SAAS,CACZd,SAAU,iB,EAMpBX,OAAA,WACE,IAAIkC,OAAUrB,EAgCd,MA/B4B,UAAxBV,KAAKO,MAAMC,SACbuB,EACE,6BACE,2DACA,yBACEhC,MAAO,CACLiC,WAAY,OACZC,OAAQ,OACRC,MAAO,SAGT,kBAAC,IAAD,QAI2B,UAAxBlC,KAAKO,MAAMC,SACpBuB,EACE,6BACE,gFACA,2BAAI/B,KAAKO,MAAME,UAGc,aAAxBT,KAAKO,MAAMC,WACpBuB,EACE,6BACE,wCACA,mFAMJ,kBAAC,IAAD,CAAQjB,SAAU,CAAEqB,SAAU,SAC5B,kBAAC,IAAD,CAAKC,MAAM,qBACX,yBAAKrC,MAAO,CAAEsC,UAAW,WAAaN,K,GAxF1B5B,IAAMC,WA8FXE,a","file":"component---src-pages-aoe-2-de-rating-charts-oauth-js-7f8b066dd1aa69d42aad.js","sourcesContent":["import React from \"react\";\r\n\r\nimport \"./spinner.css\";\r\n\r\nclass Spinner extends React.Component {\r\n  render() {\r\n    return (\r\n      <div id=\"loading\" style={this.props.style}>\r\n        <div className=\"loading-spinner\">\r\n          <div className=\"spinner-dot\"></div>\r\n          <div className=\"spinner-dot\"></div>\r\n          <div className=\"spinner-dot\"></div>\r\n          <div className=\"spinner-dot\"></div>\r\n          <div className=\"spinner-dot\"></div>\r\n          <div className=\"spinner-dot\"></div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Spinner;\r\n","import React from \"react\";\r\n\r\nimport Layout from \"../../components/layout\";\r\nimport SEO from \"../../components/seo\";\r\nimport Spinner from \"../../components/spinner\";\r\n\r\nconst REQUIRED_QUERY_PARAMS = [\"state\", \"code\", \"scope\"];\r\n\r\nclass OAuth extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      progress: \"start\",\r\n      message: undefined,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    const queryString = window.location.search;\r\n    const urlParams = new URLSearchParams(queryString);\r\n\r\n    // Verify required fields are present\r\n    for (let field of REQUIRED_QUERY_PARAMS) {\r\n      console.log(field, urlParams.get(field));\r\n      if (urlParams.get(field) === null) {\r\n        this.setState({\r\n          progress: \"error\",\r\n          message: `Missing required field '${field}'`,\r\n        });\r\n        return;\r\n      }\r\n    }\r\n\r\n    // Send the oAuth request\r\n    fetch(\r\n      `https://us-central1-age-of-empires-307521.cloudfunctions.net/twitch-rating-charts-oauth?code=${urlParams.get(\r\n        \"code\"\r\n      )}&state=${urlParams.get(\"state\")}&scope=${urlParams.get(\"scope\")}`\r\n    )\r\n      .then(response => {\r\n        if (response.status == 204) {\r\n          return Promise.resolve();\r\n        } else {\r\n          return response.json();\r\n        }\r\n      })\r\n      .then(data => {\r\n        if (data) {\r\n          this.setState({\r\n            progress: \"error\",\r\n            message: data.message,\r\n          });\r\n        } else {\r\n          this.setState({\r\n            progress: \"complete\",\r\n          });\r\n        }\r\n      });\r\n  }\r\n\r\n  render() {\r\n    let content = undefined;\r\n    if (this.state.progress === \"start\") {\r\n      content = (\r\n        <div>\r\n          <h1>Processing oAuth Request...</h1>\r\n          <div\r\n            style={{\r\n              paddingTop: \"25px\",\r\n              margin: \"auto\",\r\n              width: \"42px\",\r\n            }}\r\n          >\r\n            <Spinner></Spinner>\r\n          </div>\r\n        </div>\r\n      );\r\n    } else if (this.state.progress === \"error\") {\r\n      content = (\r\n        <div>\r\n          <h1>There was an error while processing your request</h1>\r\n          <p>{this.state.message}</p>\r\n        </div>\r\n      );\r\n    } else if (this.state.progress === \"complete\") {\r\n      content = (\r\n        <div>\r\n          <h1>Success!</h1>\r\n          <p>Processing complete, you may now close this window</p>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <Layout location={{ pathname: \"/404\" }}>\r\n        <SEO title=\"oAuth Processing\" />\r\n        <div style={{ textAlign: \"center\" }}>{content}</div>\r\n      </Layout>\r\n    );\r\n  }\r\n}\r\n\r\nexport default OAuth;\r\n"],"sourceRoot":""}