{"version":3,"file":"component---src-pages-never-before-js-b9e6a483c8d27e1ffe53.js","mappings":"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","sources":["webpack://endlesswips/./src/pages/never-before.js"],"sourcesContent":["import React from \"react\";\r\nimport Layout from \"../components/layout\";\r\nimport SEO from \"../components/seo\";\r\nimport Spinner from \"../components/spinner\";\r\nimport Utils from \"../helpers/utils\";\r\n\r\nimport sha256 from \"crypto-js/sha256\";\r\nimport Base64 from \"crypto-js/enc-base64\";\r\n\r\nimport KaleidoscopeColoring from \"../components/kaleidoscope-coloring\";\r\n\r\nclass NeverBefore extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      uniqueId: undefined,\r\n      variant: \"Kaleidoscope\",\r\n      quality: 4,\r\n      color: false,\r\n      page: 1,\r\n      submitted: false,\r\n    };\r\n  }\r\n\r\n  getFieldUpdateFunction(fieldName) {\r\n    return function (e) {\r\n      let stateUpdate = {};\r\n      if (e.target.type === \"checkbox\") {\r\n        stateUpdate[fieldName] = e.target.checked;\r\n      } else {\r\n        stateUpdate[fieldName] = e.target.value;\r\n      }\r\n      this.setState(stateUpdate);\r\n    }.bind(this);\r\n  }\r\n\r\n  changePageNumber(delta) {\r\n    return function () {\r\n      if (this.state.page + delta >= 1 && this.state.page + delta <= 50)\r\n        this.setState({ page: this.state.page + delta });\r\n    }.bind(this);\r\n  }\r\n\r\n  // TODO: use ref!\r\n  downloadCanvas() {\r\n    console.log(\"Download\");\r\n    let link = document.createElement(\"a\");\r\n    link.download = `pattern.png`;\r\n    link.href = document.getElementById(\"canvas\").toDataURL();\r\n    link.click();\r\n  }\r\n\r\n  componentDidMount() {\r\n    let queryObject = Utils.getQueryObj();\r\n    if (queryObject.uniqueId !== undefined) {\r\n      this.setState({\r\n        uniqueId: Utils.invMakeBase64UrlSafe(queryObject.uniqueId),\r\n      });\r\n    } else if (queryObject.id !== undefined) {\r\n      this.setState({\r\n        uniqueId: Utils.invMakeBase64UrlSafe(queryObject.id),\r\n      });\r\n    } else {\r\n      this.setState({ uniqueId: null });\r\n    }\r\n\r\n    if (\r\n      (queryObject.uniqueId !== undefined || queryObject.id !== undefined) &&\r\n      queryObject.variant !== undefined\r\n    ) {\r\n      this.setState({ submitted: true });\r\n    }\r\n\r\n    if (queryObject.variant !== undefined) {\r\n      this.setState({ variant: queryObject.variant });\r\n    } else {\r\n      this.setState({ variant: null });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    let inputHash = this.state.uniqueId;\r\n    for (let i = 1; i < this.state.page; i++) {\r\n      let lastChar = inputHash.slice(-1);\r\n      console.log(lastChar);\r\n      if (lastChar !== \"=\") {\r\n        inputHash = Utils.invMakeBase64UrlSafe(inputHash) + \"=\";\r\n      } else {\r\n        inputHash = Utils.invMakeBase64UrlSafe(inputHash);\r\n      }\r\n      //console.log(\"HASH\", inputHash);\r\n      inputHash = Base64.stringify(sha256(inputHash));\r\n    }\r\n\r\n    let content = <Spinner></Spinner>;\r\n    if (this.state.submitted === false) {\r\n      content = (\r\n        <div>\r\n          <p>\r\n            Please enter the <b>uniqueId</b> and <b>variant</b> of your coloring\r\n            book. These can be found of the back cover.\r\n          </p>\r\n          <div>\r\n            <label htmlFor=\"variant\">Variant</label>\r\n            <div>\r\n              <input\r\n                id=\"variant\"\r\n                name=\"variant\"\r\n                type=\"text\"\r\n                placeholder=\"\"\r\n                value={this.state.variant}\r\n                disabled={true}\r\n                onChange={function (e) {\r\n                  this.setState({\r\n                    variant: e.target.value,\r\n                  });\r\n                }.bind(this)}\r\n              ></input>\r\n            </div>\r\n            <label htmlFor=\"uniqueId\">UniqueId</label>\r\n            <div>\r\n              <input\r\n                id=\"uniqueId\"\r\n                name=\"uniqueId\"\r\n                type=\"text\"\r\n                placeholder=\"\"\r\n                onChange={function (e) {\r\n                  this.setState({\r\n                    uniqueId: e.target.value,\r\n                  });\r\n                }.bind(this)}\r\n              ></input>\r\n            </div>\r\n            <div>\r\n              <button\r\n                class=\"button\"\r\n                style={{ marginTop: \"4px\", marginBottom: \"100%\" }}\r\n                onClick={function (e) {\r\n                  this.setState({\r\n                    submitted: true,\r\n                  });\r\n                }.bind(this)}\r\n              >\r\n                Submit\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    } else {\r\n      content = (\r\n        <div>\r\n          <div\r\n            style={{\r\n              display: \"flex\",\r\n              flexDirection: \"column\",\r\n              alignItems: \"center\",\r\n              marginBottom: \"4px\",\r\n            }}\r\n          >\r\n            <div\r\n              style={{\r\n                display: \"flex\",\r\n                flexDirection: \"column\",\r\n                alignItems: \"center\",\r\n              }}\r\n            >\r\n              <div>\r\n                UniqueId: <b>{Utils.makeBase64UrlSafe(this.state.uniqueId)}</b>\r\n              </div>\r\n              <div>\r\n                Variant: <b>{this.state.variant}</b>\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <button\r\n                class=\"button\"\r\n                onClick={this.changePageNumber(-1)}\r\n                style={{ marginRight: \"4px\" }}\r\n              >\r\n                {\"<\"}\r\n              </button>\r\n              Pattern{\" \"}\r\n              <input style={{ width: \"25px\" }} value={this.state.page}></input>{\" \"}\r\n              of 50\r\n              <button\r\n                class=\"button\"\r\n                onClick={this.changePageNumber(1)}\r\n                style={{ marginLeft: \"4px\" }}\r\n              >\r\n                {\">\"}\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <KaleidoscopeColoring\r\n            variant={null}\r\n            hash={inputHash}\r\n            quality={this.state.quality}\r\n            color={this.state.color}\r\n            key={sha256(this.state.quality)} // Re-make the canvas when the quality changes\r\n          ></KaleidoscopeColoring>\r\n\r\n          <div\r\n            style={{\r\n              display: \"flex\",\r\n              flexDirection: \"column\",\r\n              alignItems: \"center\",\r\n              marginBottom: \"4px\",\r\n            }}\r\n          >\r\n            <div>\r\n              <input\r\n                type=\"checkbox\"\r\n                id=\"color\"\r\n                name=\"color\"\r\n                onChange={this.getFieldUpdateFunction(\"color\")}\r\n                //checked={this.state.color}\r\n              ></input>\r\n              <label htmlFor=\"color\"> Color it for me</label>\r\n            </div>\r\n            <div style={{ display: \"flex\" }}>\r\n              <input\r\n                id=\"quality\"\r\n                type=\"range\"\r\n                min=\"1\"\r\n                max=\"10\"\r\n                onChange={this.getFieldUpdateFunction(\"quality\")}\r\n                value={this.state.quality}\r\n              ></input>\r\n              <label\r\n                for=\"quality\"\r\n                style={{\r\n                  padding: \"5px\",\r\n                }}\r\n              >\r\n                {\" \"}\r\n                Image Quality\r\n              </label>\r\n            </div>\r\n\r\n            <div>\r\n              <button class=\"button\" onClick={this.downloadCanvas}>\r\n                Download Pattern Image\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <Layout location={{ pathname: \"/never-before\" }} hideComments={true}>\r\n        <SEO\r\n          title=\"NeverBefore Coloring\"\r\n          description=\"Coloring pages generated from user input text\"\r\n        />\r\n        <div\r\n          className=\"inner-home post-list-wrapper\"\r\n          style={{ justifyContent: \"center\" }}\r\n        >\r\n          {content}\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n}\r\n\r\nexport default NeverBefore;\r\n"],"names":["NeverBefore","props","state","uniqueId","undefined","variant","quality","color","page","submitted","getFieldUpdateFunction","fieldName","e","stateUpdate","target","type","checked","value","this","setState","bind","changePageNumber","delta","downloadCanvas","console","log","link","document","createElement","download","href","getElementById","toDataURL","click","componentDidMount","queryObject","Utils","id","render","inputHash","i","lastChar","slice","Base64","sha256","content","htmlFor","name","placeholder","disabled","onChange","class","style","marginTop","marginBottom","onClick","display","flexDirection","alignItems","marginRight","width","marginLeft","hash","key","min","max","for","padding","location","pathname","hideComments","title","description","className","justifyContent","React"],"sourceRoot":""}